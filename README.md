# Dongguk Graduation FE




# 이 밑은 메모장임!!

🎓 프로젝트 개요
  본 프로젝트는 학생들의 전체 학생 명단(Excel)과 개별 성적표 묶음(ZIP)을 업로드받아, 데이터를 분석하고 졸업 요건 충족 여부를 판별하는 웹 애플리케이션입니다. 보안을 위해 민감한 개인정보(학번 등)는 프론트엔드에서
  암호화하여 처리하도록 설계되었습니다.


  🛠 1. 기술 스택
   - Framework: React (TypeScript)
   - Build Tool: Vite
   - State Management: Zustand (전역 상태 관리)
   - Library:
     - xlsx: 엑셀 파일(.xlsx) 데이터 파싱 및 가공
     - jszip: 압축 파일(.zip) 내 여러 엑셀 파일 동시 처리
     - crypto-js (추정): 학번 암호화(SHA256) 처리


  📊 2. 핵심 데이터 구조 (TypeScript Types)
  데이터의 일관성을 위해 세분화된 인터페이스를 정의했습니다.
   - `StudentMeta`: 학생 마스터 정보 (학번, 이름, 입학연도, 주전공, 복수전공, 어학점수 등)
   - `GradeRow`: 성적표의 각 행 데이터 (이수구분, 과목명, 학점, 등급, 재수강 여부 등)
   - `StudentRecord`: 위 두 데이터를 병합한 최종 객체 (프론트엔드 관리용)
   - `BackendStudentPayload`: 백엔드 분석용 익명화 데이터 (학번/이름 제외, 암호화 ID 포함)

  ⚙️ 3. 주요 서비스 로직 (Services)
  데이터 파싱부터 분석까지의 파이프라인을 구축했습니다.


  ① 데이터 파싱 (Parsing)
   - `parseStudentExcel`: 업로드된 전체 학생 명단 엑셀을 읽어 학번을 Key로 하는 인덱스(studentIndex)를 생성합니다.
   - `ZipService`: 성적표 ZIP 파일 내에서 성적정보_{학번}.xlsx 형태의 파일들을 추출하고 개별 학생의 성적 데이터를 객체화합니다.


  ② 데이터 병합 (Merging)
   - `mergeStudents`: 학생 마스터 정보와 ZIP 내의 성적 데이터를 매칭합니다.
     - 정상: 양쪽 데이터가 모두 존재할 때 병합
     - 누락 처리: 성적표는 있는데 마스터 정보가 없거나, 반대로 마스터 정보는 있는데 성적표가 없는 케이스를 분류하여 에러 메시지를 생성합니다.


  ③ 졸업 요건 계산 (Calculation)
   - `calculateCredits`: 동국대학교 이수 체계에 맞춰 학점을 분류합니다.
     - 이수구분별: 전공필수(전필), 전공선택(전선), 공통교양(교필), 일반교양(교선), 자유선택(자선)
     - 영역별: MSC(수학, 과학, 전산), 영어강의 이수 횟수 등
     - 성적: P/NP를 제외한 평균 평점(GPA) 계산


  ④ 보안 (Security)
   - `encryptId`: 학번을 그대로 서버에 보내지 않고 SHA256으로 해싱하여 개인정보 유출을 방지합니다.


  🖥 4. 애플리케이션 흐름 (Workflows)
   1. Upload Step: 사용자가 학생정보 엑셀과 성적 ZIP 파일을 업로드합니다.
   2. Processing Step: 파일 파싱 및 병합이 진행되며 실시간 프로그레스 바를 통해 진행률을 보여줍니다.
   3. Preview Step: 병합된 데이터의 미리보기를 제공하며, 이상 데이터(누락 등)를 확인합니다.
   4. Final Analysis: 가공된 데이터를 백엔드로 전송하여 상세 졸업 시뮬레이션 결과를 받아옵니다.


  ✅ 현재 진행 상황 요약
   - [x] 프로젝트 기본 환경 구성 및 타입 정의 완료
   - [x] Zustand를 활용한 전역 상태 저장소 설계
   - [x] 엑셀/ZIP 파일 파싱 핵심 로직 구현 완료
   - [x] 학생 데이터 매칭 및 예외 케이스 처리 로직 완료
   - [x] 기본 이수 학점 및 GPA 계산 엔진 구현 완료


🏗️ 1. 프로젝트 폴더 및 파일 구조 (Project Architecture)


  이 프로젝트는 기능적 역할에 따라 엄격하게 분리된 계층형 구조를 가지고 있습니다.


   - `/src/types/index.ts`: 전체 시스템의 '설계도'입니다. 데이터의 생김새를 정의하며 모든 서비스는 이 타입을 기준으로 동작합니다.
   - `/src/store/useStore.ts`: 애플리케이션의 '단기 기억(상태)'입니다. 업로드된 데이터와 진행 상황을 전역에서 관리합니다.
   - `/src/services/`: 애플리케이션의 '두뇌'입니다. 엑셀을 읽고, 압축을 풀고, 학점을 계산하는 핵심 비즈니스 로직이 들어있습니다.
   - `/src/pages/`: 사용자가 마주하는 '얼굴'입니다. 단계별 UI(업로드 → 처리 → 결과)를 담당합니다.

  ---


  📄 2. 데이터 모델 상세 분석 (/src/types/index.ts)

  단순한 데이터 저장이 아닌, 데이터의 흐름을 제어하기 위한 4단계 모델링을 채택했습니다.


   1. `GradeRow` (성적표 로우 데이터):
       * 엑셀 시트의 한 줄 한 줄을 객체화한 것입니다.
       * yearSemester(년도학기), subjectCode(학수번호), category(이수구분 - 전필/전선 등), credits(학점), grade(등급) 등 동국대 성적표의 모든 필드를 매핑합니다.
       * retake... 필드를 통해 재수강 여부까지 추적할 수 있도록 설계되었습니다.


   2. `StudentMeta` (학생 기본 정보):                                                                                                                                                                             
       * 학생 명단 엑셀에서 추출한 프로필 정보입니다.                                                                                                                                                             
       * admissionYear(입학연도)는 졸업 요건 적용의 기준이 되며, minors(복수전공 리스트)는 전공 요건 변동을 판단하는 핵심 데이터입니다.                                                                           
                                                                                                                                                                                                                  
                                                                                                                                                                                                                  
   3. `StudentRecord` (통합 레코드):
       * 가장 중요한 타입입니다. StudentMeta와 GradeRow[]를 합치고, status 필드를 추가했습니다.
       * status: 'normal'(정상), 'missing_grades'(성적표 없음), 'missing_info'(명단에 없음), 'parsing_error'(파일 손상) 중 하나를 가져 데이터의 무결성을 프론트에서 즉시 확인할 수 있습니다.


   4. `BackendStudentPayload` (익명화 데이터):
       * 보안을 위해 설계된 타입입니다. 서버로 보낼 때 studentId(학번)와 name(이름)을 삭제하고 오직 encryptedId(SHA256 해시값)만 포함합니다.

  ---


  🧠 3. 서비스 로직 상세 기능 (/src/services/)


  📂 parseStudentExcel.ts (학생 명단 분석기)
   * `parseStudentExcel(file: File)`:
       1. FileReader를 이용해 바이너리 데이터를 읽습니다.
       2. XLSX 라이브러리로 엑셀을 JSON 배열로 변환합니다.
       3. 단순히 배열로 두지 않고, 학번을 Key로 하는 Map(Object) 구조로 재가공합니다. 이는 나중에 수천 명의 성적표와 매칭할 때 $O(1)$의 속도로 즉시 찾기 위함입니다.


  🤐 parseZipGrades.ts (성적표 ZIP 압축 해제기)
   * `ZipService.getFileList(zipFile)`:
       * JSZip을 사용하여 압축 내 파일 목록을 스캔합니다.
       * 정규표현식 성적정보_(\d+)\.xlsx을 사용하여 유효한 성적표 파일만 필터링합니다.
   * `ZipService.parseGradeExcel(zipEntry)`:
       * 압축 내의 개별 엑셀 파일을 비동기적으로 읽어 GradeRow[] 배열로 변환합니다.
       * 동국대 성적표 특유의 컬럼명(예: '이수구분영역')을 코드에서 사용하기 쉬운 카멜케이스 속성명으로 변환합니다.


  🔗 mergeStudents.ts (데이터 결합 오케스트레이터)
  이 프로젝트의 가장 복잡한 로직이 담긴 곳입니다.
   * `mergeStudents(...)`:
       1. 1단계(ZIP 기준): ZIP 내 파일을 하나씩 돌며, 미리 만들어둔 studentIndex에서 해당 학생을 찾습니다. 찾으면 합치고, 없으면 missing_info 상태로 기록합니다.
       2. 2단계(명단 기준): 반대로 명단에는 있는데 ZIP 파일이 없는 학생들을 찾아 missing_grades 상태로 생성합니다.
       3. 실시간 보고: 각 파일 처리 시마다 onProgress 콜백을 호출하여 UI의 프로그레스 바를 갱신합니다.


  🧮 calculateGraduation.ts (학점 계산 엔진)
   * `calculateCredits(grades: GradeRow[])`:
       * 누적 합산: 전필, 전선, 공교, 일교, 자선 등 이수구분별로 학점을 실시간 분류 합산합니다.
       * 영역 분석: 동국대의 독특한 영역인 MSC(수학/과학/전산) 학점을 별도로 추출합니다.
       * 영어 강의: englishType 필드를 검사하여 전공영어 및 일반 영어강의 이수 횟수를 카운트합니다.
       * GPA 계산: A+를 4.5점으로 변환하는 매핑 테이블을 사용하여, P/NP 과목을 제외한 평균 평점을 산출합니다.

  ---

  🏪 4. 전역 상태 관리 (/src/store/useStore.ts)


  Zustand를 사용하여 애플리케이션 전체에서 공유되는 상태를 관리합니다.                                                                                                                                            
                                                                                                                                                                                                                  
                                                                                                                                                                                                                  
   * `step`: 현재 화면이 '업로드'인지, '분석 중'인지, '결과 확인'인지를 결정하는 상태값입니다.
   * `studentIndex`: 파싱된 학생 명단을 임시 보관하는 캐시입니다.
   * `students`: 모든 처리가 끝난 최종 학생 리스트입니다.
   * `totalFiles`, `processedFiles`: 대량의 데이터를 처리할 때 사용자에게 진행률을 보여주기 위한 카운터입니다.

  ---


  🌊 5. 데이터 흐름 시나리오 (Data Flow)


   1. 입력: 사용자가 명단.xlsx와 성적.zip을 선택합니다.
   2. 명단 처리: parseStudentExcel이 실행되어 메모리에 학번-학생 매핑 테이블을 만듭니다.
   3. 성적 처리: mergeStudents가 루프를 돌며 ZIP 내부 파일을 하나씩 ZipService로 분석합니다.
   4. 계산: 각 파일 분석 직후 calculateCredits가 돌아가며 해당 학생의 학점 요약을 즉시 계산합니다.
   5. 암호화: encryptId를 통해 학번이 해싱 처리됩니다.
   6. 출력: 모든 처리가 완료되면 students 상태가 업데이트되고, PreviewPage에서 상태별(정상/누락 등) 필터링이 가능해집니다.

  ---


  이 설계는 수천 명의 학생 데이터를 브라우저 메모리 내에서 안전하고 빠르게 처리할 수 있도록 최적화되어 있으며, 동국대학교의 복잡한 이수 체계를 유연하게 수용할 수 있는 구조를 갖추고 있습니다.






  






